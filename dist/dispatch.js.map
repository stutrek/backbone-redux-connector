{"version":3,"sources":["../src/dispatch.js"],"names":["module","exports","vent","marionetteDispatch","dispatch","Backbone","Marionette","_","trigger","extend","Events","wrapInitialize","type","oldInitialize","prototype","initialize","on","eventType","event","reduxDispatchInProgress","reduxActionInProgress","createAction","action","substr","bind","apply","arguments","Application"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAAUC,IAAV,EAAgB;AAChC,QAAO,SAASC,kBAAT,CAA6BC,QAA7B,EAAuCC,QAAvC,EAAiDC,UAAjD,EAA6DC,CAA7D,EAAgE;AACtEL,SAAOA,KAAKM,OAAL,GAAeN,IAAf,GAAsBK,EAAEE,MAAF,CAASP,IAAT,EAAeG,SAASK,MAAxB,CAA7B;;AAEA,WAASC,cAAT,CAAwBC,IAAxB,EAA8B;AAC7B,OAAIC,gBAAgBR,SAASO,IAAT,EAAeE,SAAf,CAAyBC,UAA7C;AACAV,YAASO,IAAT,EAAeE,SAAf,CAAyBC,UAAzB,GAAsC,YAAY;AACjD,SAAKC,EAAL,CAAQ,KAAR,EAAe,UAAUC,SAAV,EAAqBC,KAArB,EAA4B;AAC1C,SAAIhB,KAAKiB,uBAAL,IAAgCjB,KAAKkB,qBAAzC,EAAgE;AAC/D;AACA;AACD,SAAI,KAAKC,YAAT,EAAuB;AACtB,UAAIC,SAAS,KAAKD,YAAL,CAAkBJ,SAAlB,EAA6BC,KAA7B,CAAb;AACA,UAAII,MAAJ,EAAY;AACX,WAAIA,OAAOV,IAAP,CAAYW,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,MAA6B,UAAjC,EAA6C;AAC5CnB,iBAASkB,MAAT;AACA,QAFD,MAEO;AACNpB,aAAKiB,uBAAL,GAA+BG,MAA/B;AACAlB,iBAASkB,MAAT;AACApB,aAAKiB,uBAAL,GAA+B,KAA/B;AACA;AACD;AACD;AACD,KAhBc,CAgBbK,IAhBa,CAgBR,IAhBQ,CAAf;AAiBAX,kBAAcY,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;AACA,IAnBD;AAoBA;;AAEDpB,aAAWqB,WAAX,CAAuBb,SAAvB,CAAiCV,QAAjC,GAA4C,UAAUkB,MAAV,EAAkB;AAC7D,OAAIA,OAAOV,IAAP,CAAYW,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,MAA6B,UAAjC,EAA6C;AAC5CnB,aAASkB,MAAT;AACA,IAFD,MAEO;AACNpB,SAAKiB,uBAAL,GAA+BG,MAA/B;AACAlB,aAASkB,MAAT;AACApB,SAAKiB,uBAAL,GAA+B,KAA/B;AACA;AACD,GARD;;AAUAR,iBAAe,OAAf;AACAA,iBAAe,YAAf;AACA,EAvCD;AAwCA,CAzCD","file":"dispatch.js","sourcesContent":["module.exports = function (vent) {\n\treturn function marionetteDispatch (dispatch, Backbone, Marionette, _) {\n\t\tvent = vent.trigger ? vent : _.extend(vent, Backbone.Events);\n\n\t\tfunction wrapInitialize(type) {\n\t\t\tvar oldInitialize = Backbone[type].prototype.initialize;\n\t\t\tBackbone[type].prototype.initialize = function () {\n\t\t\t\tthis.on('all', function (eventType, event) {\n\t\t\t\t\tif (vent.reduxDispatchInProgress || vent.reduxActionInProgress) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.createAction) {\n\t\t\t\t\t\tvar action = this.createAction(eventType, event);\n\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\tif (action.type.substr(0, 8) === '@@router') {\n\t\t\t\t\t\t\t\tdispatch(action);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvent.reduxDispatchInProgress = action;\n\t\t\t\t\t\t\t\tdispatch(action);\n\t\t\t\t\t\t\t\tvent.reduxDispatchInProgress = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t\toldInitialize.apply(this, arguments);\n\t\t\t}\n\t\t}\n\n\t\tMarionette.Application.prototype.dispatch = function (action) {\n\t\t\tif (action.type.substr(0, 8) === '@@router') {\n\t\t\t\tdispatch(action);\n\t\t\t} else {\n\t\t\t\tvent.reduxDispatchInProgress = action;\n\t\t\t\tdispatch(action);\n\t\t\t\tvent.reduxDispatchInProgress = false;\n\t\t\t}\n\t\t};\n\n\t\twrapInitialize('Model');\n\t\twrapInitialize('Collection');\n\t};\n}\n"]}